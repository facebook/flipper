<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.68">
<link rel="search" type="application/opensearchdescription+xml" title="Flipper" href="/opensearch.xml">
<script src="https://buttons.github.io/buttons.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
<script src="/js/code-blocks-buttons.js"></script>
<script src="/js/google-analytics.js"></script><title data-react-helmet="true">Implementing a Flipper Client | Flipper</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Implementing a Flipper Client | Flipper"><meta data-react-helmet="true" name="description" content="In the GitHub repo, you&#x27;ll find Flipper clients for Android, iOS and C++ code, but there&#x27;s nothing to stop you from writing a FlipperClient for another device or OS."><meta data-react-helmet="true" property="og:description" content="In the GitHub repo, you&#x27;ll find Flipper clients for Android, iOS and C++ code, but there&#x27;s nothing to stop you from writing a FlipperClient for another device or OS."><meta data-react-helmet="true" property="og:url" content="https://fbflipper.com//docs/extending/new-clients"><link data-react-helmet="true" rel="shortcut icon" href="/img/icon.png"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://fbflipper.com//docs/extending/new-clients"><link rel="stylesheet" href="/styles.ede05923.css">
<link rel="preload" href="/styles.82c4951a.js" as="script">
<link rel="preload" href="/runtime~main.54c5dd75.js" as="script">
<link rel="preload" href="/main.ee5c6263.js" as="script">
<link rel="preload" href="/1.744db94b.js" as="script">
<link rel="preload" href="/70.ba3130a7.js" as="script">
<link rel="preload" href="/73.def975d9.js" as="script">
<link rel="preload" href="/935f2afb.7d2a613d.js" as="script">
<link rel="preload" href="/69.7041db55.js" as="script">
<link rel="preload" href="/c2a203b4.cf172080.js" as="script">
</head>
<body>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_2AhQ">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/icon.png" alt="Flipper Logo" class="themedImage_2E_h themedImage--light_AouX navbar__logo"><img alt="Flipper Logo" class="themedImage_2E_h themedImage--dark_1YPN navbar__logo"><strong class="navbar__title">Flipper</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/features/index">Features</a><a class="navbar__item navbar__link" href="/docs/getting-started/index">Setup</a><a class="navbar__item navbar__link" href="/docs/tutorial/intro">Creating Plugins</a><a href="https://github.com/facebook/flipper" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a class="navbar__item navbar__link" href="/docs/internals/index">Under the Hood</a><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">⌘</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/icon.png" alt="Flipper Logo" class="themedImage_2E_h themedImage--light_AouX navbar__logo"><img alt="Flipper Logo" class="themedImage_2E_h themedImage--dark_1YPN navbar__logo"><strong class="navbar__title">Flipper</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/features/index">Features</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/getting-started/index">Setup</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/tutorial/intro">Creating Plugins</a></li><li class="menu__list-item"><a href="https://github.com/facebook/flipper" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/internals/index">Under the Hood</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive thin-scrollbar menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/index">Desktop App</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Adding Flipper to your app</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/android-native">Android with Gradle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/ios-native">Generic iOS apps</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">React Native</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/react-native">Automatic Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/react-native-android">Manual Android Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/react-native-ios">Manual iOS Setup</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/troubleshooting">Troubleshooting Issues</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Other Platforms</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/extending/new-clients">Implementing a Flipper Client</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/extending/establishing-a-connection">Secure Communication</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/extending/supporting-layout">Implementing Layout Inspection</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Plugin Setup</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/setup/layout-plugin">Layout Inspector</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/setup/navigation-plugin">Navigation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/setup/network-plugin">Network</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/setup/databases-plugin">Databases</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/setup/images-plugin">Images</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/setup/sandbox-plugin">Sandbox</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/setup/shared-preferences-plugin">Shared Preferences</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/setup/leak-canary-plugin">LeakCanary</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/setup/crash-reporter-plugin">Crash Reporter</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Advanced</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/custom-ports">Using different ports</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/stetho">Stetho Guidance</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_39qw"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Implementing a Flipper Client</h1></header><div class="markdown"><p>In the GitHub repo, you&#x27;ll find Flipper clients for Android, iOS and C++ code, but there&#x27;s nothing to stop you from writing a FlipperClient for another device or OS.</p><p>Flipper clients communicate with the Flipper desktop app using JSON RPC messages over an <a href="http://rsocket.io/" target="_blank" rel="noopener noreferrer">RSocket</a> connection.</p><p>This page documents the API, and you can use <a href="https://github.com/facebook/flipper/blob/master/xplat/Flipper/FlipperConnectionManagerImpl.cpp" target="_blank" rel="noopener noreferrer">FlipperConnectionManagerImpl.cpp</a> for reference.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="establishing-a-connection"></a>Establishing a connection<a aria-hidden="true" class="hash-link" href="#establishing-a-connection" title="Direct link to heading">#</a></h2><p>Start by connecting to the Flipper server running within the desktop app. Connecting to the server registers your application with Flipper and enables plugins to interact with it. As the Flipper desktop has a different lifecycle than your app and may connect and disconnect at any time it is important that you attempt to reconnect to the Flipper server until it accepts your connection.</p><p>We use the RSocket protocol for communication between desktop and client, because it allows for easy certificate pinning and functionality like request-response messages.</p><p>In order to securely connect to Flipper, your client should first <a href="/docs/extending/establishing-a-connection">obtain a certificate</a>.</p><p>After the client certificate has been obtained, connect to the following URL with an RSocket client:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">localhost:8088/sonar?os={OS}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                     &amp;device={DEVICE}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                     &amp;device_id={DEVICE_ID}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                     &amp;app={APP}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                     &amp;sdk_version={SDK_VERSION}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                     &amp;foreground={FOREGROUND}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p><strong>OS</strong>: The OS which the connecting is being established from. For example <code>os=Android</code> if your client is running on Android. This is usually hard-coded into the FlipperClient implementation. This string may be used by the Flipper desktop app to identify valid plugins as well as present in the UI to the user.</p><p><strong>DEVICE</strong>: The name of the device running the application. For example <code>device=iPhone7</code>.</p><p><strong>DEVICE_ID</strong>: A unique identifier for the device. The Flipper server / desktop app may use this to coalesce multiple connections originating from the save device or present the string in the UI to differentiate between connections to different clients.</p><p><strong>APP</strong>: The name of the app running this client instance. For example <code>app=Facebook</code> when connecting to a running facebook app. OS + DEVICE_ID + APP should together uniquely identify a connection.</p><p><strong>FOREGROUND</strong>: A boolean indicating whether this connection was established with a foreground process. This is a hint to the Flipper desktop app of whether to re-focus on this connection or not. For example <code>foreground=true</code>. This parameter is recommended but optional.</p><p><strong>SDK_VERSION</strong>: A number indicating the latest protocol version this client is compatible with. You can find the current version in our <a href="https://github.com/facebook/flipper/blob/master/xplat/Flipper/FlipperConnectionManagerImpl.cpp#L37" target="_blank" rel="noopener noreferrer">C++ connection implementation</a>. Usually stored as a constant in the client code, this allows protocol changes to be made whilst still preserving connectivity with old clients. When Flipper desktop encounters an old SDK version, it may attempt to communicate using a matching protocol. However, backwards compatibility is not guaranteed and you should strive to update clients on the rare occasion that the protocol version advances.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="responding-to-messages"></a>Responding to messages<a aria-hidden="true" class="hash-link" href="#responding-to-messages" title="Direct link to heading">#</a></h2><p>Flipper uses a simple Remote Procedure Call protocol using JSON-formatted payloads.</p><p>The <code>method</code> field of the payload indicates which method of the FlipperClient is being called. This will always be present.</p><p>The <code>payload</code> field contains the JSON parameters for the method call. This may be omitted when no parameters are used.</p><p>It is recommended that implementations gracefully ignore extra fields for the sake of backwards and forwards compatibility.</p><p>Responses contain either a success object representing the return value of the RPC invocation or an error object indicating that an error occurred.</p><p><strong>The following methods must be implemented by all FlipperClient implementations</strong>:</p><p>The syntax used for these type definitions is <a href="https://flow.org/en/docs/types/objects/" target="_blank" rel="noopener noreferrer">Flow</a>. All requests/responses are JSON objects. Where no Response type is specified, it&#x27;s a void call - no response is expected.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="getplugins"></a>getPlugins<a aria-hidden="true" class="hash-link" href="#getplugins" title="Direct link to heading">#</a></h3><p>Return the available plugins as a list of identifiers. A plugin identifier is a string which is matched with the plugin identifier of desktop javascript plugins. This allows the client to specify the plugins it supports.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Request = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;method&quot;: &quot;getPlugins&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Response = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;success&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;plugins&quot;: Array&lt;string&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="getbackgroundplugins"></a>getBackgroundPlugins<a aria-hidden="true" class="hash-link" href="#getbackgroundplugins" title="Direct link to heading">#</a></h3><p>Returns a subset of the available plugins returned by <code>getPlugin</code>. The background connections will automatically receive a connection from Flipper once it starts (and if the plugins are enabled), rather than waiting for the user to open the plugin.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Request = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;method&quot;: &quot;getBackgroundPlugins&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Response = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;success&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;plugins&quot;: Array&lt;string&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="init"></a>init<a aria-hidden="true" class="hash-link" href="#init" title="Direct link to heading">#</a></h3><p>Initialize a plugin. This should result in an onConnected call on the appropriate plugin. Plugins should by nature be lazy and should not be initialized up front as this may incur significant cost. The Flipper desktop client knows when a plugin is needed and should control when to initialize them.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Request = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;method&quot;: &quot;init&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;params&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;plugin&quot;: string,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="deinit"></a>deinit<a aria-hidden="true" class="hash-link" href="#deinit" title="Direct link to heading">#</a></h3><p>Opposite of init. A call to deinit is made when a plugin is no longer needed and should release any resources. Don&#x27;t rely only on deinit to release plugin resources as Flipper may quit without having the chance to issue a deinit call. In those cases, you should also rely on the RSocket disconnect callbacks. This call is mainly for allowing the desktop app to control the lifecycle of plugins.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Request = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;method&quot;: &quot;deinit&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;params&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;plugin&quot;: string,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="execute"></a>execute<a aria-hidden="true" class="hash-link" href="#execute" title="Direct link to heading">#</a></h3><p>This is the main call and how the Flipper desktop plugins and client plugins communicate. When a javascript desktop plugin issues a client request it will be wrapped in one of these execute calls. This execute indicates that the call should be redirected to a plugin.
request.params.api is the plugin id.
request.params.method is the method within the plugin to execute.
request.params.params is an optional params object containing the parameters to the RPC invocation.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Request = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;method&quot;: &quot;execute&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;params&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;api&quot;: string,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;method&quot;: string,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;params&quot;: ?Object,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Response = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;success&quot;: Object,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">} | {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;error&quot;: Object,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="error-reporting"></a>Error Reporting<a aria-hidden="true" class="hash-link" href="#error-reporting" title="Direct link to heading">#</a></h2><p>The Flipper desktop app handles error reporting so you don&#x27;t have to. If an error occurs during the execution of an RPC invocation, return a serialization of it in the response so it can be attributed to the method call.</p><p>If an error occurs in some other context, you can proactively send it to Flipper with the following request structure:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Request = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  error: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    message: string,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    stacktrace: string,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>While in development mode, Flipper will display any client errors next to javascript errors in the Electron/Chrome DevTools console.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="testing"></a>Testing<a aria-hidden="true" class="hash-link" href="#testing" title="Direct link to heading">#</a></h2><p>Testing is incredibly important when building core infrastructure and tools. The following is pseudo code for tests we would expect any new FlipperClient implementation to implement and correctly execute. To run tests we strongly encourage you to build a mock for the RSocket connection to mock out the desktop side of the protocol and to not have any network dependencies in your test code.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">test(&quot;GetPlugins&quot;, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  let connection = new MockConnection();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  let client = new FlipperClient(connection);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  let plugin = {id: &quot;test&quot;};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  client.addPlugin(plugin);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  client.start();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  connection.onReceive({</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    id: 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    method: &quot;getPlugins&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  });</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  assert(connection.sentMessages, contains({</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    id: 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    success:{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      plugins: [&quot;test&quot;],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">});</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">test(&quot;InitDeinit&quot;, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  let connection = new MockConnection();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  let client = new FlipperClient(connection);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  let plugin = {id: &quot;test&quot;, connected: false};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  client.addPlugin(plugin);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  client.start();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  assertFalse(plugin.connected);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  connection.onReceive({</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    id: 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    method: &quot;init&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    params: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      plugin: &quot;test&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  });</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  assertTrue(plugin.connected);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  connection.onReceive({</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    id: 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    method: &quot;deinit&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    params: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      plugin: &quot;test&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  });</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  assertFalse(plugin.connected);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">});</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">test(&quot;Disconnect&quot;, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  let connection = new MockConnection();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  let client = new FlipperClient(connection);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  let plugin = {id: &quot;test&quot;, connected: false};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  client.addPlugin(plugin);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  client.start();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  assertFalse(plugin.connected);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  connection.onReceive({</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    id: 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    method: &quot;init&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    params: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      plugin: &quot;test&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  });</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  assertTrue(plugin.connected);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  connection.disconnect();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  assertFalse(plugin.connected);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">});</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">test(&quot;Execute&quot;, {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  let connection = new MockConnection();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  let client = new FlipperClient(connection);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  let plugin = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    id: &quot;test&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    reverse: (params, responder) =&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      responder.success({word: params.word.reverse()});</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  client.addPlugin(plugin);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  client.start();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  connection.onReceive({</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    id: 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    method: &quot;init&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    params: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      plugin: &quot;test&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  });</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  connection.onReceive({</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    id: 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    method: &quot;execute&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    params: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      api: &quot;test&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      method: &quot;reverse&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      params: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        word: &quot;hello&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  });</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  assert(connection.sentMessages, contains({</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    id: 1,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    success:{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      word: &quot;olleh&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">});</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/flipper/blob/master/website/../docs/extending/new-clients.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/troubleshooting"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Troubleshooting Issues</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/extending/establishing-a-connection"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Secure Communication »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_ thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#establishing-a-connection" class="table-of-contents__link">Establishing a connection</a></li><li><a href="#responding-to-messages" class="table-of-contents__link">Responding to messages</a><ul><li><a href="#getplugins" class="table-of-contents__link">getPlugins</a></li><li><a href="#getbackgroundplugins" class="table-of-contents__link">getBackgroundPlugins</a></li><li><a href="#init" class="table-of-contents__link">init</a></li><li><a href="#deinit" class="table-of-contents__link">deinit</a></li><li><a href="#execute" class="table-of-contents__link">execute</a></li></ul></li><li><a href="#error-reporting" class="table-of-contents__link">Error Reporting</a></li><li><a href="#testing" class="table-of-contents__link">Testing</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Learn</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/index">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tutorial/intro">Plugin Creation Tutorial</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Plugins</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/features/index">Core Plugins</a></li><li class="footer__item"><a href="https://www.npmjs.com/search?q=keywords:flipper-plugin" target="_blank" rel="noopener noreferrer" class="footer__link-item">Community Plugins</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Legal</h4><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/flipper_fb" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://github.com/facebook/flipper" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><img class="footer__logo" alt="Flipper Mascot" src="/img/mascot.png"></div><div>Copyright © 2021 Facebook</div></div></div></footer></div>
<script src="/styles.82c4951a.js"></script>
<script src="/runtime~main.54c5dd75.js"></script>
<script src="/main.ee5c6263.js"></script>
<script src="/1.744db94b.js"></script>
<script src="/70.ba3130a7.js"></script>
<script src="/73.def975d9.js"></script>
<script src="/935f2afb.7d2a613d.js"></script>
<script src="/69.7041db55.js"></script>
<script src="/c2a203b4.cf172080.js"></script>
</body>
</html>