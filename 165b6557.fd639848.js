(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{139:function(e,n,t){"use strict";t.d(n,"a",(function(){return p})),t.d(n,"b",(function(){return b}));var r=t(0),i=t.n(r);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var u=i.a.createContext({}),s=function(e){var n=i.a.useContext(u),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},p=function(e){var n=s(e.components);return i.a.createElement(u.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return i.a.createElement(i.a.Fragment,{},n)}},f=i.a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,a=e.originalType,o=e.parentName,u=c(e,["components","mdxType","originalType","parentName"]),p=s(t),f=r,b=p["".concat(o,".").concat(f)]||p[f]||d[f]||a;return t?i.a.createElement(b,l(l({ref:n},u),{},{components:t})):i.a.createElement(b,l({ref:n},u))}));function b(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var a=t.length,o=new Array(a);o[0]=f;var l={};for(var c in n)hasOwnProperty.call(n,c)&&(l[c]=n[c]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var u=2;u<a;u++)o[u]=t[u];return i.a.createElement.apply(null,o)}return i.a.createElement.apply(null,t)}f.displayName="MDXCreateElement"},140:function(e,n,t){"use strict";t.d(n,"b",(function(){return a})),t.d(n,"a",(function(){return o}));var r=t(142),i=t(141);function a(){var e=Object(r.default)().siteConfig,n=(e=void 0===e?{}:e).baseUrl,t=void 0===n?"/":n,a=e.url;return{withBaseUrl:function(e,n){return function(e,n,t,r){var a=void 0===r?{}:r,o=a.forcePrependBaseUrl,l=void 0!==o&&o,c=a.absolute,u=void 0!==c&&c;if(!t)return t;if(t.startsWith("#"))return t;if(Object(i.b)(t))return t;if(l)return n+t;var s=t.startsWith(n)?t:n+t.replace(/^\//,"");return u?e+s:s}(a,t,e,n)}}}function o(e,n){return void 0===n&&(n={}),(0,a().withBaseUrl)(e,n)}},141:function(e,n,t){"use strict";function r(e){return!0===/^(\w*:|\/\/)/.test(e)}function i(e){return void 0!==e&&!r(e)}t.d(n,"b",(function(){return r})),t.d(n,"a",(function(){return i}))},142:function(e,n,t){"use strict";t.r(n);var r=t(0),i=t(20);n.default=function(){var e=Object(r.useContext)(i.a);if(null===e)throw new Error("Docusaurus context not provided");return e}},145:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return i})),t.d(n,"useAllPluginInstancesData",(function(){return a})),t.d(n,"usePluginData",(function(){return o}));var r=t(142);function i(){var e=Object(r.default)().globalData;if(!e)throw new Error("Docusaurus global data not found");return e}function a(e){var n=i()[e];if(!n)throw new Error("Docusaurus plugin global data not found for pluginName="+e);return n}function o(e,n){void 0===n&&(n="default");var t=a(e)[n];if(!t)throw new Error("Docusaurus plugin global data not found for pluginName="+e+" and pluginId="+n);return t}},147:function(e,n,t){(function(n){const r=["internal","external"];let i;try{i=t(145).usePluginData}catch(c){i=null}function a(e){return function(e){if("object"!=typeof e)throw new Error(`fbContent() args must be an object containing keys: ${r}. Instead got ${e}`);if(!Object.keys(e).find((e=>r.find((n=>n===e)))))throw new Error(`No valid args found in ${JSON.stringify(e)}. Accepted keys: ${r}`);const n=Object.keys(e).filter((e=>!r.find((n=>n===e))));if(n.length>0)throw new Error(`Unexpected keys ${n} found in fbContent() args. Accepted keys: ${r}`)}(e),l()?"internal"in e?o(e.internal):[]:"external"in e?o(e.external):[]}function o(e){return"function"==typeof e?e():e}function l(){return n.env.FB_INTERNAL||i&&i("internaldocs-fb").FB_INTERNAL}e.exports={fbContent:a,fbInternalOnly:function(e){return a({internal:e})},isInternal:l,FbInternalOnly:function(e){return l()?e.children:null},OssOnly:function(e){return l()?null:e.children}}}).call(this,t(148))},148:function(e,n){var t,r,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function l(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var c,u=[],s=!1,p=-1;function d(){s&&c&&(s=!1,c.length?u=c.concat(u):p=-1,u.length&&f())}function f(){if(!s){var e=l(d);s=!0;for(var n=u.length;n;){for(c=u,u=[];++p<n;)c&&c[p].run();p=-1,n=u.length}c=null,s=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(n){try{return r.call(null,e)}catch(n){return r.call(this,e)}}}(e)}}function b(e,n){this.fun=e,this.array=n}function m(){}i.nextTick=function(e){var n=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)n[t-1]=arguments[t];u.push(new b(e,n)),1!==u.length||s||l(f)},b.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},69:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return c})),t.d(n,"metadata",(function(){return u})),t.d(n,"rightToc",(function(){return s})),t.d(n,"default",(function(){return d}));var r=t(3),i=t(7),a=(t(0),t(139)),o=t(140),l=t(147),c={id:"ios",title:"Building an iOS Plugin"},u={unversionedId:"tutorial/ios",id:"tutorial/ios",isDocsHomePage:!1,title:"Building an iOS Plugin",description:"For the purpose of the tutorial, we will assume you already have an existing iOS application in",source:"@site/../docs/tutorial/ios.mdx",slug:"/tutorial/ios",permalink:"/docs/tutorial/ios",editUrl:"https://github.com/facebook/flipper/blob/master/website/../docs/tutorial/ios.mdx",version:"current",sidebar:"extending",previous:{title:"Intro",permalink:"/docs/tutorial/intro"},next:{title:"Building an Android Plugin",permalink:"/docs/tutorial/android"}},s=[{value:"Creating a Plugin",id:"creating-a-plugin",children:[]},{value:"Registering your Plugin",id:"registering-your-plugin",children:[]},{value:"What next",id:"what-next",children:[]}],p={rightToc:s};function d(e){var n=e.components,t=Object(i.a)(e,["components"]);return Object(a.b)("wrapper",Object(r.a)({},p,t,{components:n,mdxType:"MDXLayout"}),Object(a.b)("img",{alt:"iOS Tutorial App",src:Object(o.a)("img/ios-tutorial-app.png")}),Object(a.b)("p",null,"For the purpose of the tutorial, we will assume you already have an existing iOS application in\nwhich you have a feed or list of items. As the Flipper team, we obviously concern ourselves mostly\nwith sea mammals, so this is what our app displays. The actual display logic is not what's interesting\nhere, but how we can make this data available in our Flipper desktop app."),Object(a.b)("p",null,"You can find the source code of the project ",Object(a.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/facebook/flipper/tree/c55bebd1be545c63dde93e143dd5c341dc2fd20b/iOS/Tutorial/Tutorial"}),"on GitHub"),"."),Object(a.b)("h2",{id:"creating-a-plugin"},"Creating a Plugin"),Object(a.b)(l.FbInternalOnly,{mdxType:"FbInternalOnly"},Object(a.b)("div",{class:"warning"},"[FB-Only] Depending the options selected during scaffolding (see intro), some of the following code might already have been generated by `scarf`.")),Object(a.b)("p",null,"On iOS, a Flipper plugin is a class that implements the\n",Object(a.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/facebook/flipper/blob/master/iOS/FlipperKit/FlipperPlugin.h"}),Object(a.b)("inlineCode",{parentName:"a"},"FlipperPlugin")),"\ninterface."),Object(a.b)("p",null,"The interface is rather small and only comprises four methods:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("inlineCode",{parentName:"li"},"(NSString *)identifier"),": Specify a unique string so the JavaScript side knows where to talk to. This must match the name attribute in the ",Object(a.b)("inlineCode",{parentName:"li"},"package.json")," we will look into later in this tutorial."),Object(a.b)("li",{parentName:"ul"},Object(a.b)("inlineCode",{parentName:"li"},"(void)didConnect:(id<FlipperConnection>)connection"),": This method is called when the desktop client connects and is ready to receive or send data."),Object(a.b)("li",{parentName:"ul"},Object(a.b)("inlineCode",{parentName:"li"},"(void)didDisconnect"),": We're sure you can figure this one out."),Object(a.b)("li",{parentName:"ul"},Object(a.b)("inlineCode",{parentName:"li"},"(BOOL)runInBackground"),": Unless this is true, only the currently selected plugin in the Flipper UI can communicate with the device. Its an optional method which you can override. Default value used is ",Object(a.b)("inlineCode",{parentName:"li"},"false"),".")),Object(a.b)("p",null,"Let's implement these methods for our sealife app:"),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-swift"}),'import Foundation\nimport FlipperKit\n\nclass SeaMammalsPlugin: NSObject, FlipperPlugin {\n  var connection: FlipperConnection? = nil\n  let mammals: [MarineMammal]\n\n  init(_ marineMammals: [MarineMammal]) {\n      mammals = marineMammals\n  }\n\n  func identifier() -> String! {\n    return "sea-mammals"\n  }\n\n  func didConnect(_ connection: FlipperConnection!) {\n    self.connection = connection\n    for (index, mammal) in mammals.enumerated() {\n      connection.send("newRow", withParams: ["id": index, "title": mammal.name, "url": mammal.image.absoluteString])\n    }\n  }\n\n  func didDisconnect() {\n    connection = nil;\n  }\n}\n')),Object(a.b)("p",null,"The two interesting bits here are ",Object(a.b)("inlineCode",{parentName:"p"},"didConnect")," and ",Object(a.b)("inlineCode",{parentName:"p"},"connection.send"),". ",Object(a.b)("inlineCode",{parentName:"p"},"connection.send"),' sends a message\nto the desktop app and is identified with the name "newRow".'),Object(a.b)("p",null,"For our sample app, we're dealing with a static data source. However, in real\nlife, you will likely dynamically receive new data as the user interacts with\nthe app. So while we just send all the data we have at once in ",Object(a.b)("inlineCode",{parentName:"p"},"didConnect"),",\nyou would normally set up a listener here to instead call ",Object(a.b)("inlineCode",{parentName:"p"},'connection.send("newRow", params)')," as new data\narrives. ",Object(a.b)("inlineCode",{parentName:"p"},"params")," are nothing but a dictionary which contains the data which you want to send over the wire to the desktop app."),Object(a.b)("h2",{id:"registering-your-plugin"},"Registering your Plugin"),Object(a.b)("p",null,"Now all you need to do is let Flipper know about your new plugin. You do this\nby calling ",Object(a.b)("inlineCode",{parentName:"p"},"add")," on your ",Object(a.b)("inlineCode",{parentName:"p"},"FlipperClient"),", which is normally created\nat application startup."),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-swift"}),"let client = FlipperClient.shared()\n// Add all sorts of other amazing plugins here ...\nclient?.add(SeaMammalsPlugin(MarineMammal.defaultList))\nclient?.start()\n")),Object(a.b)("h2",{id:"what-next"},"What next"),Object(a.b)("p",null,'When starting your application now, Flipper will tell the desktop application\nabout the plugin it supports, including "sea-mammals" and will look for a\ncorresponding JavaScript plugin by that name. Before building it\'s JavaScript counterpart, first lets build a Flipper Plugin in Android.'))}d.isMDXComponent=!0}}]);